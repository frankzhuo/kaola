--------10.5.28.14------sh 
1.总体
nohup sh /data/KaolaCrawler-7/bin/run.sh &
2。商标
nohup  sh /data/KaolaCrawler-7-jyk/bin/run_biaodunwangsb2.sh > /data/KaolaCrawler-7-jyk/bin/run_biaodunwangsb2.log &
nohup  sh /data/KaolaCrawler-7-jyk/bin/run_biaodunwangsb.sh > /data/KaolaCrawler-7-jyk/bin/run_biaodunwangsb.log &  //只能一个执行
3。点评
nohup sh /data/KaolaCrawler-7-jyk4/bin/run_dianpingshanghuiddetail.sh > /data/KaolaCrawler-7-jyk4/bin/run_dianpingshanghuiddetail.log &
nohup sh /data/KaolaCrawler-7-jyk2/bin/run_dianpingshanghuvaliddetail2.sh > /data/KaolaCrawler-7-jyk2/bin/run_dianpingshanghuvaliddetail2.log &
nohup sh /data/KaolaCrawler-7-jyk3/bin/run_dianpingshanghuvalididdetailhttpclient3.sh > /data/KaolaCrawler-7-jyk3/bin/run_dianpingshanghuvalididdetailhttpclient3.log &
nohup sh /data/KaolaCrawler-7-jyk3/bin/run_dianpingshanghuvalididdetailhttpclient4.sh > /data/KaolaCrawler-7-jyk3/bin/run_dianpingshanghuvalididdetailhttpclient4.log &

nohup sh /data/KaolaCrawler-7-jyk3/bin/run_dianpingshanghuid.sh > /data/KaolaCrawler-7-jyk3/bin/run_dianpingshanghuid.log & ？？？？？？？？？？？？



20170313
-----------------
clouderManager hostmonitor 发生内部错误：解决方式： 重起：Cloudera Management Service 
10.5.28.14 不能上网，需配置DNS 
[root@trs-14 squid]# cat /etc/resolv.conf 
# Generated by NetworkManager
nameserver 219.141.136.10

# No nameservers found; try putting DNS servers into your
# ifcfg files in /etc/sysconfig/network-scripts like so:
#
# DNS1=xxx.xxx.xxx.xxx
# DNS2=xxx.xxx.xxx.xxx
# DOMAIN=lab.foo.com bar.foo.com



cat run_dianpingshanghuvalididdetailhttpclient3.sh 
#!/bin/sh
JAVA_CMD="java"
SEIMI_HOME=".."
SEIMI_CLASS_PATH=".:$SEIMI_HOME/seimi/classes:$SEIMI_HOME/seimi/lib/*"
SEIMI_SYS_ARGS="-Dfile.encoding=UTF-8"
$JAVA_CMD -cp $SEIMI_CLASS_PATH $SEIMI_SYS_ARGS com.kaola.crawlers.DianPingShangHuValidIdDetailHttpClient

eclipse 依赖性 打jar包
clean  compile  assembly:assembly (勾选 Skip Tests)
一般性 常规打包
选中项目-> Run Configurations -> clean package install (勾选 Skip Tests)

proxy
14：cd /etc/squid/ & vi squid.conf
service squid restart

#外部商户  导入到hbase  最后由restful接口调用
hadoop16上，/home/hdfs/wbpos_atmtxnjnl_work/cronjob_wbpos_atmt.sh

#10.5.28.14 下 /data/crawler/opencourtbeijing*.txt 通过Flume加载到ES中

#es测试启动
10.5.28.11  service elasticsearch restart
10.5.28.13  cd /root/elasticsearch-1.7.2/bin && ./elasticsearch -d

#查询集群的文档数
curl -XGET 'http://10.5.28.11:9200/_count' -d '{"query":{"match_all":{}}}'

//清空
curl -XDELETE 'http://localhost:9200/law_open_court/open_court_notice/_query?pretty' -d'{
"query":{"match":{"publish_time":"1990-01-01"}
}
}'

//10.5.26.13（非拉卡拉商户评分)
#/home/hdfs/shanghu/merzx_import.sh
create table hds.wbpos_msmerchant as select * from hds.imp_wbpos_msmerchant where trim(partnerno) ='823173993@qq.com' or trim(partnerno) ='sdxjsbh' or trim( partnerno) ='13614202108' or trim(partnerno) ='18604206666';
rownum:9391
create table hds.wbpos_msmerchant as select * from hds.imp_wbpos_msmerchant where trim(partnerno) in ('Sunlong','Sixiaogao','AGE01655','15366062118','15026292122','2933510161','T146404','1492504072','15599891985','15299831991');
hive -e "select count(1) from hds.wbpos_msmerchant;" //108816

注意：在使用sqoop export时 要停止mr的12 11的NodeManager12 NodeManager11


#检查hdfs文件健康状况
sudo -u hdfs hadoop  fsck /

#10.5.28.14 下运行爬虫
/data/KaolaCrawler-7

[杨晓婷]
个人评分		hadoop08
代码路径		/home/hdfs/creditck/
主程序脚本		cdt_cronjob_process.sh
导出程序		cdt_cronjob_export.sh
评分结果表		hive中creditck.cdt_final_score_grade_limit_push
导出oracle		10.1.2.187:1521/crdnewdb 	EM/em_1234	CDT_SCORE_FINAL
crontab			
	0 12 * * * sh /home/hdfs/creditck/cdt_cronjob_process.sh > /home/hdfs/creditck/logs/cdt_cronjob_process.log 2>&1
	0 3 * * * sh /home/hdfs/creditck/cdt_cronjob_export.sh > /home/hdfs/creditck/logs/cdt_cronjob_export.log 2>&1

law_court:
原有:2015-07  至 2015-11		

/// xshell 调用 eclipse 
vi /etc/ssh/sshd_config X11Forwarding yes 
echo $DISPLAY
xhost + #yum install xhost
yum install xorg-x11-xauth 
//yum groupinstall "Desktop" -y
 
//run as configurations (Edata)
package assembly:assembly (Goals) ,Skip Tests (勾选)

//run as configurations (Edata)
clean  compile   assembly:assembly(Goals), Skip Tests (勾选),Skip Tests (勾选)

//redis 
keys peoplecountbulletin  //查看key
del peoplecountbulletin   //删除key

//正式网hive底层impala:hive授权
su hdfs
dfs -ls /user/hive/warehouse/hdw.db/lklpos_atmtxnjnl;
dfs -chown -R impala:hive  /user/hive/warehouse/merzx.db/var_stockholder_zb;


#hadoop 10 
grant CREATE on database default to group zhengxin;
show grant user zx_t;
show grant group zhengxin;

#判断文件存在
filename="/data/edata/peoplecountbulletin_init/peoplecountbulletin_2016-07-22.txtr"
if test -s $filename ;then
   echo "file exists"
else
   echo "file empty"
fi

///类型转换 
case when source in ('xd','gd','dlm','pp','wd') then '信用记录'
              when source in ('fa') then '身份属性'
              when source in ('uc') then '交易行为'
信用记录包括：信贷逾期/小贷,光大黑名单,p2p(dlm黑名单),p2p(pp黑名单),p2p(wd黑名单)
身份属性包括：法院黑名单（老赖）
交易行为包括：用户中心黑名单uc

其中以下属于组合：
交易行为,信用记录
交易行为,身份属性
信用记录,身份属性 

///解决中文乱码
安装中文字符
yum groupinstall chinese-support
临时 LANG="zh_CN.UTF-8"
永久 vi /etc/sysconfig/i18n

///安装chromium 
yum install https://people.centos.org/hughesjr/chromium/6/i386/RPMS/chromium-28.0.1500.95-213514.i686.rpm
wget --no-check-certificate https://raw.github.com/hughesjr/chromium_el_builder/master/chrome_pepperflash_copy.sh
su - jyk
LANG="zh_CN.UTF-8"
cd /opt/chromium/ &&./chrome


//trs-14 svn
svnserve -d -r /data/svn

///在trs-13上测试　hbase HFile
#hbase http://www.tuicool.com/articles/j2Ejq2m
create 'user_info','city'

create 'user_info1','city'

hdfs dfs -put /root/jyk/user.txt /user/yarn
sudo -u hbase hbase org.apache.hadoop.hbase.mapreduce.ImportTsv -Dimporttsv.separator=',' -Dimporttsv.columns='HBASE_ROW_KEY,city' -Dimporttsv.bulk.output=/hbase/data/output user_info /user/yarn
sudo -u hbase hbase org.apache.hadoop.hbase.mapreduce.LoadIncrementalHFiles /hbase/data/output user_info

sudo -u hbase hdfs dfs -rmr hdfs://trs-13:8020/hbase/data/output

///　在trs-13上测试
sqoop eval --connect jdbc:oracle:thin:@10.5.19.26:1521/ZXDB --username merscore --password merscore  --query "select * from CDT_MERPRECREDIT where rownum <10";

sqoop eval --connect jdbc:oracle:thin:@10.5.19.26:1521/ZXDB --username merscore --password merscore  --query "delete from CDT_MERPRECREDIT";

//此时需要停止trs-12 trs-11 的ｎｏｄｅＭａｎａｇｅｒ节点
sudo -u hdfs  sqoop export --connect jdbc:oracle:thin:@10.5.19.26:1521/ZXDB --username merscore --password merscore --table CDT_MERPRECREDIT  --export-dir  /user/hive/warehouse/merzx.db/mer_limit_result_push  --fields-terminated-by '\001' --input-null-string '\\N' --input-null-non-string '\\N' --update-key MERID,ORGID --update-mode allowinsert -m 2

//18 /home/hdfs/xiaodai/xiaodai.sql
sudo -u hdfs sqoop eval --connect ${oracle_jdbc} --username ${oracle_username} --password ${oracle_password} --query "delete from ${oracle_black_table}";

//商户云平台运行流程
19上运行集市，/home/zx_t/merdm/merdm_script/mer_base_day.sql
18上运行评分，/home/hdfs/merzx/merzx.sh
18上运行授信，/home/hdfs/merzx/mer_shouxin_limit.sh
18上运行云平台，/home/hdfs/merzx/mer_cloud.sh


http://hadoop06:7180/cmf/services/20/status
admin/hadoop@lakala